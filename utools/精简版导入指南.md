# 精简版 Cookie 导入指南 🎯

> **推荐使用！** 自动清空旧 Cookie + 只导入必要的 4 个关键 Cookie

---

## ⚡ 一键导入（3步）

### 第 1 步：打开文件
打开文件：`utools/import_user2_essential.js`

### 第 2 步：复制代码
全选并复制（`Ctrl+A`, `Ctrl+C`）

### 第 3 步：浏览器执行

1. 访问 https://wx.10086.cn
2. 按 `F12` → `Console` 标签
3. 粘贴代码 → 按 `Enter`
4. 等待显示 "全部完成!"
5. 按 `F5` 刷新页面

✅ **完成！** 

---

## 📊 这个脚本做了什么？

### ✅ 自动清空旧 Cookie
- 避免旧 Cookie 与新 Cookie 冲突
- 确保干净的登录环境
- 清空所有域名和路径下的 Cookie

### ✅ 只导入 4 个必要 Cookie
```
1. shareToken  - 授权token（最重要）
2. riskToken   - 风控token
3. uuid        - 用户唯一标识
4. clientId    - 客户端ID
```

### ✅ 智能验证
- 自动检测导入是否成功
- 彩色输出，一目了然
- 详细的结果表格

---

## 🎨 执行效果预览

```javascript
🚀 开始导入 user2 的必要 Cookies...

📝 步骤 1: 清空旧 Cookies
✓ 已清空 15 个旧 Cookie

📝 步骤 2: 导入必要 Cookies
准备导入 4 个必要 Cookie:
shareToken, riskToken, uuid, clientId

✓ clientId
✓ shareToken
✓ riskToken
✓ uuid

✅ 导入完成!
✓ 成功: 4
✗ 失败: 0
📊 总计: 4

详细结果:
┌───────────┬────────┬─────────────────────┐
│   name    │ status │       value         │
├───────────┼────────┼─────────────────────┤
│ clientId  │ ✓ 成功 │ 2d716501-5442-4d... │
│shareToken │ ✓ 成功 │ m-gp5A.ybB2rH-Svc...│
│ riskToken │ ✓ 成功 │ 6940e650Rdws5uSq... │
│   uuid    │ ✓ 成功 │ 8c5540bc-287d-44... │
└───────────┴────────┴─────────────────────┘

💡 下一步操作:
1️⃣  刷新页面 (按 F5 或 Ctrl+R)
2️⃣  检查是否已登录
3️⃣  如果仍未登录，可能需要重新获取最新的 Cookie

🎉 全部完成! 请刷新页面查看效果
```

---

## 🆚 对比：完整版 vs 精简版

| 特性 | 完整版 | 精简版（推荐）|
|-----|--------|--------------|
| Cookie 数量 | ~50+ 个 | 4 个关键 |
| 清空旧 Cookie | ❌ 不清空 | ✅ 自动清空 |
| 导入速度 | 较慢 | 很快 |
| 安全性 | 一般 | 更好 |
| 冲突风险 | 可能有 | 无 |
| 推荐度 | ⭐⭐⭐ | ⭐⭐⭐⭐⭐ |

---

## 📁 相关文件

| 文件 | 说明 |
|-----|------|
| `import_user2_essential.js` | **精简版脚本** - 直接使用 |
| `import_user2_cookies.js` | 完整版脚本 |
| `import_essential_cookies.py` | 精简版脚本生成器 |
| `generate_cookie_import_script.py` | 完整版脚本生成器 |

---

## ❓ 常见问题

### Q: 为什么只导入 4 个 Cookie？
**A:** 这 4 个是登录所需的**最核心** Cookie：
- `shareToken` - 授权凭证，必需
- `riskToken` - 风控验证，必需  
- `uuid` - 用户标识，必需
- `clientId` - 客户端ID，必需

其他 Cookie（如埋点、统计等）在刷新后会自动生成。

---

### Q: 清空旧 Cookie 安全吗？
**A:** 完全安全！
- 只清空 `wx.10086.cn` 域名的 Cookie
- 不影响其他网站
- 导入新 Cookie 后立即可用

---

### Q: 如果导入后还是未登录怎么办？
**A:** 按以下步骤检查：

1. **刷新页面** (F5) - 80% 的情况下刷新即可
2. **检查 Cookie** - F12 → Application → Cookies
3. **验证 shareToken** - 确认 shareToken 存在且正确
4. **重新获取** - 如果 Cookie 过期，需要重新登录获取

---

### Q: 什么时候用完整版，什么时候用精简版？
**A:** 

| 场景 | 推荐版本 |
|-----|---------|
| 快速登录测试 | ✅ 精简版 |
| 日常使用 | ✅ 精简版 |
| 首次导入 | ✅ 精简版 |
| Cookie 冲突 | ✅ 精简版（自动清空）|
| 特殊功能需要 | 完整版 |

**总结：99% 的情况用精简版即可！**

---

## 🔄 如何生成其他用户的精简脚本

### User1 精简版
```bash
cd d:\work\10086
python utools/import_essential_cookies.py
# 选择 1 (user1)
```

### 自定义必要 Cookie
编辑 `import_essential_cookies.py` 的第 9 行：
```python
ESSENTIAL_COOKIES = [
    'shareToken',
    'riskToken', 
    'uuid',
    'clientId',
    # 添加你需要的其他 Cookie
    # 'sessionId',
    # 'loginToken',
]
```

---

## 💡 最佳实践

### ✅ 推荐做法
1. **使用精简版**（更快、更安全）
2. **定期更新 Cookie**（建议每周）
3. **使用隐身窗口测试**（避免影响正常账号）
4. **导入后立即刷新**（让 Cookie 生效）

### ❌ 不推荐做法
1. ~~不清空旧 Cookie 直接导入~~
2. ~~导入所有 50+ 个 Cookie~~
3. ~~使用过期的 Cookie~~
4. ~~在生产环境测试~~

---

## 🚀 快速命令汇总

```bash
# 生成 user2 精简脚本
python utools/import_essential_cookies.py
# 选择 2

# 生成 user1 精简脚本  
python utools/import_essential_cookies.py
# 选择 1

# 查看生成的脚本
code utools/import_user2_essential.js
```

---

## 🎯 总结

**精简版优势：**
- ✅ 自动清空旧 Cookie（无冲突）
- ✅ 只导入 4 个关键 Cookie（更安全）
- ✅ 执行速度快（1-2秒完成）
- ✅ 彩色输出（直观易懂）
- ✅ 自动验证（确保成功）

**使用场景：**
- 🎯 快速登录测试
- 🎯 切换账号
- 🎯 解决登录问题
- 🎯 Cookie 冲突排查
- 🎯 日常自动化使用

**下一步：**
1. 打开 `import_user2_essential.js`
2. 复制到浏览器控制台
3. 执行并刷新
4. 开始使用！

---

**最后更新**: 2025-12-17  
**推荐等级**: ⭐⭐⭐⭐⭐

