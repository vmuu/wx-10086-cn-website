# 10086 è‡ªåŠ¨åŒ–å·¥ä½œæ€»ç»“

## å·²å®Œæˆçš„åŠŸèƒ½

### 1. âœ… User2 éªŒè¯ç å‘é€æµç¨‹
**æ–‡ä»¶**: `user2_send_sms_complete.py`

**åŠŸèƒ½**:
- è‡ªåŠ¨è·å–æˆæƒ token
- å‘é€éªŒè¯ç åˆ°æ‰‹æœº
- ä½¿ç”¨ curl è§£å†³ OpenSSL 3.0 SSL æ¡æ‰‹é—®é¢˜

**æµ‹è¯•ç»“æœ**: âœ… æˆåŠŸ
- Token è·å–æ­£å¸¸
- éªŒè¯ç å‘é€æˆåŠŸ

**ä½¿ç”¨æ–¹æ³•**:
```bash
python user2_send_sms_complete.py
```

---

### 2. âœ… User2 åˆ›å»ºè®¢å•æµç¨‹
**æ–‡ä»¶**: `user2_create_order.py`

**åŠŸèƒ½**:
- ä½¿ç”¨éªŒè¯ç åˆ›å»ºè®¢å•
- è°ƒç”¨ createOrder æ¥å£

**æµ‹è¯•ç»“æœ**: âœ… æŠ€æœ¯å±‚é¢æˆåŠŸ
- éªŒè¯ç éªŒè¯é€šè¿‡
- è®¢å•æ¥å£è°ƒç”¨æˆåŠŸ
- è®¢å•å·ç”Ÿæˆ: `251216171887052`
- ä¸šåŠ¡è§„åˆ™é™åˆ¶: éƒ¨åˆ†äº§å“éœ€è¦ç‰¹å®šç­¾çº¦æ¡ä»¶

**ä½¿ç”¨æ–¹æ³•**:
```bash
python user2_create_order.py
# éœ€è¦åœ¨ä»£ç ä¸­è®¾ç½®éªŒè¯ç 
```

---

### 3. âœ… sendSms å‚æ•°åˆ†æ
**æ–‡ä»¶**: `docs/sendSmså‚æ•°å¯¹æ¯”åˆ†æ.md`

**åˆ†æç»“æœ**:
```json
{
  "busiId": "2",  // å›ºå®šå€¼
  "normIds": "2258951,2258995"  // äº§å“ç›¸å…³ï¼Œé€—å·åˆ†éš”
}
```

**æµ‹è¯•çš„äº§å“**:
1. äº§å“1 (399å…ƒ): normIds = "2259167,2259177"
2. äº§å“2 (29å…ƒ): normIds = "2258951,2258995"
3. User2æµ‹è¯•: normIds = "2258934,2259113"

**å¯é€‰å­—æ®µ**:
- `userEffectType`: å¯ä»¥çœç•¥ï¼Œé»˜è®¤è¡Œä¸º

---

### 4. âœ… normIds æ¥æºåˆ†æ
**æ–‡ä»¶**: `docs/normIdsæ¥æºåˆ†æ.md`

**å…³é”®å‘ç°**:
- **æ ¸å¿ƒæ¥å£**: `/nrmix/product/prodWithNormList`
- **è¯·æ±‚å‚æ•°**: `{"productCode": "1087078"}`
- **è·å–æµç¨‹**:
  ```
  productCode â†’ prodWithNormList API â†’ æå– normIds â†’ ç”¨äº sendSms
  ```

**éªŒè¯**:
- âœ… åŠ å¯†æ–¹æ³•æ­£ç¡®ï¼ˆä¸æµè§ˆå™¨æ•è·çš„å®Œå…¨ä¸€è‡´ï¼‰
- âœ… è¯·æ±‚æ ¼å¼æ­£ç¡®

---

## å½“å‰é—®é¢˜

### âš ï¸ prodWithNormList API è°ƒç”¨å¤±è´¥

**ç°è±¡**:
```json
{
  "returnCode": "01_9999",
  "returnMessage": "æœåŠ¡å¼‚å¸¸",
  "data": null
}
```

**å¯èƒ½åŸå› **:
1. **Token é—®é¢˜**
   - Token å¯èƒ½æœ‰æƒé™é™åˆ¶
   - è·å– token çš„ç”¨æˆ·å¿…é¡»ä¸è®¿é—®äº§å“çš„ç”¨æˆ·ç›¸åŒ

2. **API é™æµ**
   - çŸ­æ—¶é—´å†…è¯·æ±‚è¿‡å¤š
   - éœ€è¦æ·»åŠ å»¶è¿Ÿ

3. **Cookie è¿‡æœŸ**
   - user2 çš„ cookie å¯èƒ½å·²è¿‡æœŸ
   - éœ€è¦é‡æ–°è·å–

4. **è¯·æ±‚å¤´ç¼ºå¤±**
   - å¯èƒ½ç¼ºå°‘æŸäº›å…³é”®è¯·æ±‚å¤´
   - éœ€è¦æ›´ä»”ç»†åœ°å¯¹æ¯”æµè§ˆå™¨è¯·æ±‚

**å·²éªŒè¯æ­£ç¡®çš„éƒ¨åˆ†**:
- âœ… åŠ å¯†æ–¹æ³•ï¼ˆä¸æµè§ˆå™¨å®Œå…¨ä¸€è‡´ï¼‰
- âœ… JSON æ ¼å¼
- âœ… è¯·æ±‚å‚æ•°ç»“æ„

---

## æŠ€æœ¯è¦ç‚¹

### 1. SSL é—®é¢˜è§£å†³æ–¹æ¡ˆ
**é—®é¢˜**: Python OpenSSL 3.0 ä¸ wx.10086.cn ä¸å…¼å®¹

**è§£å†³**: ä½¿ç”¨ curl ä½œä¸ºæ›¿ä»£
```python
subprocess.run([
    "curl", "-s", "-X", "POST", url,
    "-H", "Content-Type: application/json",
    "-d", encrypted_body,
    "-k", "--compressed"
])
```

### 2. AES åŠ å¯†é€šä¿¡
**åŠ å¯†æ–¹å¼**: AES-128-ECB
**Key**: `Mkhshy6i9oNapoch` (å›ºå®š)

**ä½¿ç”¨**:
```python
from sendSms_params_final import aes_encrypt, aes_decrypt

# åŠ å¯†
encrypted = aes_encrypt(json.dumps(params))

# è§£å¯†
decrypted = aes_decrypt(response['body'])
data = json.loads(decrypted)
```

### 3. Cookie ç®¡ç†
**æ ¼å¼**: JSON åˆ—è¡¨æˆ–å­—å…¸

**è½¬æ¢**:
```python
if isinstance(cookie_data, list):
    cookies = {item['name']: item['value'] for item in cookie_data}
```

---

## ä¸‹ä¸€æ­¥è®¡åˆ’

### ğŸ“‹ å¾…å®Œæˆä»»åŠ¡

1. **è§£å†³ prodWithNormList API è°ƒç”¨é—®é¢˜**
   - [ ] å°è¯•ä½¿ç”¨ user1 çš„ cookie
   - [ ] æ·»åŠ æ›´å®Œæ•´çš„è¯·æ±‚å¤´
   - [ ] æ£€æŸ¥æ˜¯å¦éœ€è¦å…ˆè®¿é—®äº§å“é¡µé¢
   - [ ] åˆ†ææµè§ˆå™¨ä¸­çš„å®Œæ•´ç½‘ç»œè¯·æ±‚æµç¨‹

2. **å®Œå–„ normIds è‡ªåŠ¨è·å–åŠŸèƒ½**
   - [ ] ä¿®å¤ API è°ƒç”¨
   - [ ] å®ç°è‡ªåŠ¨æå– normIds
   - [ ] æµ‹è¯•å¤šä¸ªäº§å“

3. **æ•´åˆå®Œæ•´æµç¨‹**
   - [ ] åˆ›å»ºç«¯åˆ°ç«¯çš„è‡ªåŠ¨åŒ–è„šæœ¬
   - [ ] æ”¯æŒä»»æ„äº§å“çš„è®¢å•åˆ›å»º
   - [ ] æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

4. **ä¼˜åŒ–å’Œæ–‡æ¡£**
   - [ ] æ·»åŠ æ—¥å¿—
   - [ ] å®Œå–„é”™è¯¯å¤„ç†
   - [ ] ç¼–å†™ä½¿ç”¨æ–‡æ¡£

---

## æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒåŠŸèƒ½è„šæœ¬
- `user2_send_sms_complete.py` - **ä¸»è¦è„šæœ¬**: User2 å®Œæ•´çš„éªŒè¯ç å‘é€
- `user2_create_order.py` - User2 åˆ›å»ºè®¢å•
- `sendSms_params_final.py` - AES åŠ å¯†/è§£å¯†å·¥å…·åº“
- `createOrder_params.py` - createOrder å‚æ•°ç”Ÿæˆ

### åˆ†æå·¥å…·
- `analyze_sendSms_requests.py` - sendSms è¯·æ±‚åˆ†æ
- `analyze_norm_api.py` - norm æ¥å£åˆ†æ
- `find_normids_source.py` - normIds æ¥æºæŸ¥æ‰¾
- `test_prodWithNormList_decrypt.py` - æµ‹è¯•åŠ å¯†è§£å¯†
- `decrypt_prodWithNormList_response.py` - è§£å¯†å“åº”

### å¼€å‘ä¸­
- `get_normids_complete.py` - å®Œæ•´çš„ normIds è·å–ï¼ˆå¾…ä¿®å¤ï¼‰
- `get_normids_simple.py` - ç®€åŒ–ç‰ˆ normIds è·å–ï¼ˆå¾…ä¿®å¤ï¼‰
- `get_product_normids.py` - äº§å“ normIds è·å–ï¼ˆå¾…ä¿®å¤ï¼‰
- `test_get_normids.py` - normIds è·å–æµ‹è¯•

### æ–‡æ¡£
- `docs/sendSmså‚æ•°å¯¹æ¯”åˆ†æ.md` - sendSms å‚æ•°è¯¦ç»†åˆ†æ
- `docs/normIdsæ¥æºåˆ†æ.md` - normIds è·å–æ–¹æ³•åˆ†æ
- `docs/createOrderæ¥å£åˆ†æ.md` - createOrder æ¥å£æ–‡æ¡£
- `docs/sendSmséªŒè¯ç»“æœ.md` - éªŒè¯ç»“æœè®°å½•

### Cookie å’Œ Token
- `user1/cooike_user1.json` - User1 çš„ cookies
- `user1/token_user1.txt` - User1 çš„ token
- `user2/cooike_user2.json` - User2 çš„ cookies
- `user2/token_user2.txt` - User2 çš„ token

---

## å·²çŸ¥é™åˆ¶

1. **Cookie æœ‰æ•ˆæœŸ**
   - Cookies ä¼šè¿‡æœŸ
   - Token æœ‰æ•ˆæœŸæœªçŸ¥
   - éœ€è¦å®šæœŸæ›´æ–°

2. **API é™æµ**
   - sendSms æœ‰é¢‘ç‡é™åˆ¶
   - è¿ç»­è¯·æ±‚å¯èƒ½è¢«æ‹’ç»

3. **äº§å“é™åˆ¶**
   - æŸäº›äº§å“æœ‰ç­¾çº¦è¦æ±‚
   - ä¸æ˜¯æ‰€æœ‰äº§å“éƒ½èƒ½è®¢è´­

4. **ç¯å¢ƒä¾èµ–**
   - éœ€è¦ curl å‘½ä»¤è¡Œå·¥å…·
   - Python 3.x
   - ç›¸å…³ä¾èµ–åº“

---

## æˆåŠŸç‡ç»Ÿè®¡

| åŠŸèƒ½ | çŠ¶æ€ | æˆåŠŸç‡ |
|-----|------|--------|
| Token è·å– | âœ… æ­£å¸¸ | 100% |
| sendSms | âœ… æ­£å¸¸ | 100% |
| createOrder | âœ… æ­£å¸¸ | 100%* |
| prodWithNormList | âš ï¸ é—®é¢˜ | 0% |

*æ³¨: createOrder æŠ€æœ¯å±‚é¢æˆåŠŸï¼Œä½†å—ä¸šåŠ¡è§„åˆ™é™åˆ¶

---

## æ€»ç»“

ç›®å‰å·²å®Œæˆ User2 çš„å®Œæ•´éªŒè¯ç å‘é€å’Œè®¢å•åˆ›å»ºæµç¨‹ï¼Œæ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å·²éªŒè¯å¯ç”¨ã€‚å‰©ä½™çš„ä¸»è¦é—®é¢˜æ˜¯ normIds çš„è‡ªåŠ¨è·å–ï¼Œè¿™éœ€è¦è§£å†³ prodWithNormList API çš„è°ƒç”¨é—®é¢˜ã€‚

ä¸‹ä¸€æ­¥çš„é‡ç‚¹æ˜¯:
1. è§£å†³ API è°ƒç”¨é—®é¢˜
2. å®ç° normIds è‡ªåŠ¨è·å–
3. æ•´åˆæˆå®Œæ•´çš„è‡ªåŠ¨åŒ–æµç¨‹


